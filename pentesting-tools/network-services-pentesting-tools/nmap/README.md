# Nmap

### 1. **Schneller Überblick: Welche Ports sind offen?**

Finde schnell die am häufigsten genutzten offenen Ports:

```bash
nmap -Pn -T4 example.com
```

* **-Pn**: Keine Ping-Abfrage (ideal, wenn ICMP blockiert ist).
* **-T4**: Schnellere Scan-Geschwindigkeit.

***

### 2. **Alle Ports scannen**

Manchmal laufen Dienste auf ungewöhnlichen Ports, daher solltest du alle Ports scannen:

```bash
nmap -p- -T4 example.com
```

* **-p-**: Scannt alle 65.535 Ports.
* **-T4**: Schnelleres Scannen.

***

### 3. **Dienst- und Versions-Scan**

Finde heraus, welche Dienste und Versionen auf den Ports laufen:

```bash
nmap -sV -p- example.com
```

* **-sV**: Versionserkennung der Dienste.

***

### 4. **Betriebssystem-Erkennung**

Falls du das Betriebssystem des Ziels herausfinden möchtest:

```bash
nmap -O example.com
```

* **-O**: Betriebssystem-Erkennung aktivieren.

***

### 5. **Skript-basierter Schwachstellenscan**

Prüfe das Ziel auf bekannte Schwachstellen:

```bash
nmap --script vuln example.com
```

* **--script vuln**: Nmap führt Skripte aus, um nach bekannten Schwachstellen (z.B. Heartbleed) zu suchen.

***

### 6. **Aggressiver Scan mit vielen Informationen**

Wenn du schnell alles über das Ziel erfahren willst:

```bash
nmap -A example.com
```

* **-A**: Aktiviert Betriebssystem-Erkennung, Versionsprüfung, Skripte und Traceroute in einem Scan.

***

### 7. **Scan mit fragmentierten Paketen**

Um Firewalls zu umgehen, kannst du die Datenpakete fragmentieren (in Stücke aufteilen):

```bash
nmap -f example.com
```

* **-f**: Sendet fragmentierte Pakete, um Firewalls und Filter zu umgehen.

***

### 8. **Scan-Ergebnisse speichern**

Speichere deine Scan-Ergebnisse, um sie später zu analysieren:

```bash
nmap -oN results.txt example.com
```

* **-oN**: Speichert den Scan in eine Datei (`results.txt`).

***

## Anonym/Unaufällige Scans

### **Unauffälliger Scan (SYN-Scan)**

Wenn du diskret scannen möchtest, um nicht entdeckt zu werden:

```bash
nmap -sS -T2 example.com
```

* **-sS**: SYN-Scan, oft unauffällig.
* **-T2**: Langsamer Scan, um weniger Spuren zu hinterlassen.

**1. TCP ACK-Scan (`-sA`)**

* **Was es macht**: Sendet nur ACK-Pakete, um zu sehen, ob ein Port durch eine Firewall gefiltert wird. Es prüft nicht, ob der Port offen ist, sondern ob er "erreichbar" ist.
* **Wann verwenden**: Um zu überprüfen, ob eine Firewall existiert und ob sie bestimmte Ports blockiert.
* **Zweck**: Erkennung von Firewalls und Filterung, ohne einen vollständigen Verbindungsaufbau.

```bash
nmap -sA example.com
```

**Beispiel-Ergebnis**:

```plaintext
plaintextCode kopierenPORT    STATE    SERVICE
80/tcp  filtered http
443/tcp filtered https
```

**filtered** bedeutet, dass der Port wahrscheinlich durch eine Firewall geschützt ist. Du kannst überlegen, ob du Methoden zur Umgehung der Firewall (z.B. Fragmentierung, Tarn-IP-Adressen) verwenden möchtest.

**2. TCP FIN-Scan (`-sF`)**

* **Was es macht**: Sendet ein FIN-Paket, was normalerweise das Ende einer TCP-Verbindung signalisiert. Viele Systeme erwarten jedoch eine vorherige Verbindungsanforderung (SYN), was den Scan verdeckt macht.
* **Wann verwenden**: Wenn du vermutest, dass eine Firewall SYN-Scans blockiert, aber FIN-Pakete nicht beachtet.
* **Zweck**: Um Ports zu erkennen, ohne durch Firewalls oder IDS entdeckt zu werden.

```bash
nmap -sF example.com
```

**3. Xmas-Scan (`-sX`)**

* **Was es macht**: Sendet ein Paket mit den TCP-Flags FIN, PSH und URG gleichzeitig gesetzt. Dieses Paket ist ungewöhnlich und kann von einigen Firewalls nicht richtig behandelt werden.
* **Wann verwenden**: Um Firewalls und IDS-Systeme zu umgehen, die auf normale Verbindungsanforderungen ausgelegt sind.
* **Zweck**: Erkennung offener und geschlossener Ports durch ungewöhnliche TCP-Flags.

```bash
nmap -sX example.com
```

**4. Null-Scan (`-sN`)**

* **Was es macht**: Sendet ein Paket ohne gesetzte TCP-Flags. Viele Systeme reagieren darauf nicht, was dazu führt, dass der Scan unentdeckt bleibt.
* **Wann verwenden**: Um Firewalls und IDS-Systeme zu umgehen, die auf typische TCP-Scans reagieren.
* **Zweck**: Ports identifizieren, die auf ungewöhnliche Pakete nicht richtig reagieren.

```bash
nmap -sN example.com
```

#### Unterschiede zwischen diesen Scans:

* **`-sS` (SYN-Scan)**: Halb-offener Scan, schnell und unauffällig, keine vollständige Verbindung.
* **`-sA` (ACK-Scan)**: Erkennt Firewalls, prüft aber nicht, ob Ports offen oder geschlossen sind.
* **`-sF`, `-sX`, `-sN` (FIN-, Xmas-, Null-Scan)**: Verwenden ungewöhnliche TCP-Flags, um Firewalls und IDS-Systeme zu umgehen.

### Timing-Templates (Scan-Geschwindigkeit)

* **-T0 (Paranoid)**: Sehr langsam, um IDS zu umgehen (ein Paket pro 5 Minuten).
* **-T1 (Sneaky)**: Langsam, aber unauffälliger (ein Paket pro 15 Sekunden).
* **-T2 (Polite)**: Reduziert Netzwerklast (langsamer).
* **-T3 (Normal)**: Standard-Scan-Geschwindigkeit.
* **-T4 (Aggressive)**: Schnellerer Scan, geeignet für CTFs und Tests ohne Rücksicht auf IDS.
* **-T5 (Insane)**: Sehr schneller Scan, kann Netzwerke stark belasten und wird leicht entdeckt.

### **Decoy-Scan (IP-Verschleierung)**

Um deine wahre IP zu verschleiern:

```bash
nmap -sS -D RND:10 example.com
```

* **-D RND:10**: Fügt 10 zufällige Decoy-IP-Adressen hinzu, um deinen Scan zu tarnen.

### Scannen durch Tor/Proxychains

Um anonym zu scannen:

1.  Installiere Tor und Proxychains:

    ```bash
    sudo apt-get install tor proxychains
    ```
2.  Starte Tor:

    ```bash
    sudo service tor start
    ```
3.  Führe Nmap durch Proxychains aus:

    ```bash
    proxychains nmap example.com
    ```

* **Warum?**: Dies verschleiert deine IP durch das Tor-Netzwerk.

### Langsamer und unauffälliger scannen (IDS)

```bash
nmap -T1 example.com
```

* **Warum?**: Vermeidet die Erkennung durch Intrusion Detection Systeme (IDS) durch langsames Scannen.
