---
layout:
  title:
    visible: true
  description:
    visible: true
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Nmap

### 1. **Schneller √úberblick: Welche Ports sind offen?**

Finde schnell die am h√§ufigsten genutzten offenen Ports:

```bash
nmap -Pn -T4 example.com
```

* **-Pn**: Keine Ping-Abfrage (ideal, wenn ICMP blockiert ist).
* **-T4**: Schnellere Scan-Geschwindigkeit.

***

### 2. **Alle Ports scannen**

Manchmal laufen Dienste auf ungew√∂hnlichen Ports, daher solltest du alle Ports scannen:

```bash
nmap -p- -T4 example.com
```

* **-p-**: Scannt alle 65.535 Ports.
* **-T4**: Schnelleres Scannen.



***

### 3. **Dienst- und Versions-Scan**

Finde heraus, welche Dienste und Versionen auf den Ports laufen:

```bash
nmap -sV -p- example.com
```

* **-sV**: Versionserkennung der Dienste.

***

### 4. **Betriebssystem-Erkennung**

Falls du das Betriebssystem des Ziels herausfinden m√∂chtest:

```bash
nmap -O example.com
```

* **-O**: Betriebssystem-Erkennung aktivieren.

***

### 5. **Skript-basierter Schwachstellenscan**

Pr√ºfe das Ziel auf bekannte Schwachstellen:

```bash
nmap --script vuln example.com
```

* **--script vuln**: Nmap f√ºhrt Skripte aus, um nach bekannten Schwachstellen (z.B. Heartbleed) zu suchen.

***

### 6. **Aggressiver Scan mit vielen Informationen**

Wenn du schnell alles √ºber das Ziel erfahren willst:

```bash
nmap -A example.com
```

* **-A**: Aktiviert Betriebssystem-Erkennung, Versionspr√ºfung, Skripte und Traceroute in einem Scan.

***

### 7. **Scan mit fragmentierten Paketen**

Um Firewalls zu umgehen, kannst du die Datenpakete fragmentieren (in St√ºcke aufteilen):

```bash
nmap -f example.com
```

* **-f**: Sendet fragmentierte Pakete, um Firewalls und Filter zu umgehen.

***

### 8. **Scan-Ergebnisse speichern**

Speichere deine Scan-Ergebnisse, um sie sp√§ter zu analysieren:

```bash
nmap -oN results.txt example.com
```

* **-oN**: Speichert den Scan in eine Datei (`results.txt`).

***

### 9. Ausf√ºhrliche Scans

Verwende `-v` oder `-vv`, um mehr Details w√§hrend deines Scans zu sehen:

* `nmap -v example.com`: Zeigt zus√§tzliche Informationen √ºber den Scanfortschritt.
* `nmap -vv example.com`: Noch ausf√ºhrlicher mit vielen Zwischenergebnissen.

Diese Optionen geben dir mehr Einblicke, was Nmap w√§hrend des Scans tut, ohne das eigentliche Verhalten des Scans zu √§ndern.

***

### 10. Sonstige Parameter

<table data-full-width="false"><thead><tr><th width="232">Parameter</th><th>Was macht es</th></tr></thead><tbody><tr><td><code>--reason</code></td><td>Zeigt den Grund an, warum Nmap zu einem bestimmten Ergebnis gekommen ist (z.B. warum ein Port als offen, geschlossen oder gefiltert markiert wurde).</td></tr><tr><td><code>-p 22</code><br><code>-p 22,21,445</code></td><td>Scannt einen bestimmten Port (hier Port 21 ‚Äì FTP). Du kannst diesen Befehl anpassen, um andere Ports zu scannen.</td></tr><tr><td><code>--stats-every=5s</code></td><td>Zeigt alle 5 Sekunden einen Statusbericht √ºber den Fortschritt des Scans.</td></tr><tr><td><code>-n</code></td><td>Nmap verwendet nur die IP-Adressen, die du eingibst, ohne sie in Hostnamen umzuwandeln.<br>Wenn du die Scan-Geschwindigkeit erh√∂hen oder DNS-Fehler umgehen m√∂chtest.</td></tr><tr><td><code>--disable-arp-ping</code></td><td>Wenn du sicherstellen m√∂chtest, dass ARP-basierte Abfragen vermieden werden, z.B. in einem gesicherten Netzwerk oder bei IPv6-Zielen.</td></tr><tr><td><code>--packet-trace</code></td><td>Zeigt dir eine detaillierte Ausgabe jedes gesendeten und empfangenen Pakets w√§hrend des Scans.</td></tr><tr><td><code>--top-ports=10</code></td><td>Scannt die 10 oder 20 h√§ufigsten Ports. Du kannst die Anzahl der Ports anpassen (10, 20, 100, usw.).</td></tr></tbody></table>

***

## Anonym/Unauf√§llige Scans

### **Unauff√§lliger Scan (SYN-Scan)**

Wenn du diskret scannen m√∂chtest, um nicht entdeckt zu werden:

```bash
nmap -sS -T2 example.com
```

* **-sS**: SYN-Scan, oft unauff√§llig.
* **-T2**: Langsamer Scan, um weniger Spuren zu hinterlassen.

**1. TCP ACK-Scan (`-sA`)**

* **Was es macht**: Sendet nur ACK-Pakete, um zu sehen, ob ein Port durch eine Firewall gefiltert wird. Es pr√ºft nicht, ob der Port offen ist, sondern ob er "erreichbar" ist.
* **Wann verwenden**: Um zu √ºberpr√ºfen, ob eine Firewall existiert und ob sie bestimmte Ports blockiert.
* **Zweck**: Erkennung von Firewalls und Filterung, ohne einen vollst√§ndigen Verbindungsaufbau.

```bash
nmap -sA example.com
```

**Beispiel-Ergebnis**:

```plaintext
plaintextCode kopierenPORT    STATE    SERVICE
80/tcp  filtered http
443/tcp filtered https
```

**filtered** bedeutet, dass der Port wahrscheinlich durch eine Firewall gesch√ºtzt ist. Du kannst √ºberlegen, ob du Methoden zur Umgehung der Firewall (z.B. Fragmentierung, Tarn-IP-Adressen) verwenden m√∂chtest.

**2. TCP FIN-Scan (`-sF`)**

* **Was es macht**: Sendet ein FIN-Paket, was normalerweise das Ende einer TCP-Verbindung signalisiert. Viele Systeme erwarten jedoch eine vorherige Verbindungsanforderung (SYN), was den Scan verdeckt macht.
* **Wann verwenden**: Wenn du vermutest, dass eine Firewall SYN-Scans blockiert, aber FIN-Pakete nicht beachtet.
* **Zweck**: Um Ports zu erkennen, ohne durch Firewalls oder IDS entdeckt zu werden.

```bash
nmap -sF example.com
```

**3. Xmas-Scan (`-sX`)**

* **Was es macht**: Sendet ein Paket mit den TCP-Flags FIN, PSH und URG gleichzeitig gesetzt. Dieses Paket ist ungew√∂hnlich und kann von einigen Firewalls nicht richtig behandelt werden.
* **Wann verwenden**: Um Firewalls und IDS-Systeme zu umgehen, die auf normale Verbindungsanforderungen ausgelegt sind.
* **Zweck**: Erkennung offener und geschlossener Ports durch ungew√∂hnliche TCP-Flags.

```bash
nmap -sX example.com
```

**4. Null-Scan (`-sN`)**

* **Was es macht**: Sendet ein Paket ohne gesetzte TCP-Flags. Viele Systeme reagieren darauf nicht, was dazu f√ºhrt, dass der Scan unentdeckt bleibt.
* **Wann verwenden**: Um Firewalls und IDS-Systeme zu umgehen, die auf typische TCP-Scans reagieren.
* **Zweck**: Ports identifizieren, die auf ungew√∂hnliche Pakete nicht richtig reagieren.

```bash
nmap -sN example.com
```

#### Unterschiede zwischen diesen Scans:

* **`-sS` (SYN-Scan)**: Halb-offener Scan, schnell und unauff√§llig, keine vollst√§ndige Verbindung.
* **`-sA` (ACK-Scan)**: Erkennt Firewalls, pr√ºft aber nicht, ob Ports offen oder geschlossen sind.
* **`-sF`, `-sX`, `-sN` (FIN-, Xmas-, Null-Scan)**: Verwenden ungew√∂hnliche TCP-Flags, um Firewalls und IDS-Systeme zu umgehen.

***

### **Decoy-Scan (IP-Verschleierung)**

Um deine wahre IP zu verschleiern:

```bash
nmap -sS -D RND:10 example.com
```

* **-D RND:10**: F√ºgt 10 zuf√§llige Decoy-IP-Adressen hinzu, um deinen Scan zu tarnen.

***

### Scannen durch Tor/Proxychains

Um anonym zu scannen:

1.  Installiere Tor und Proxychains:

    ```bash
    sudo apt-get install tor proxychains
    ```
2.  Starte Tor:

    ```bash
    sudo service tor start
    ```
3.  F√ºhre Nmap durch Proxychains aus:

    ```bash
    proxychains nmap example.com
    ```

* **Warum?**: Dies verschleiert deine IP durch das Tor-Netzwerk.

***

### Langsamer und unauff√§lliger scannen (IDS)

```bash
nmap -T1 example.com
```

* **Warum?**: Vermeidet die Erkennung durch Intrusion Detection Systeme (IDS) durch langsames Scannen.

### Timing-Templates (Scan-Geschwindigkeit)

* **-T0 (Paranoid)**: Sehr langsam, um IDS zu umgehen (ein Paket pro 5 Minuten).
* **-T1 (Sneaky)**: Langsam, aber unauff√§lliger (ein Paket pro 15 Sekunden).
* **-T2 (Polite)**: Reduziert Netzwerklast (langsamer).
* **-T3 (Normal)**: Standard-Scan-Geschwindigkeit.
* **-T4 (Aggressive)**: Schnellerer Scan, geeignet f√ºr CTFs und Tests ohne R√ºcksicht auf IDS.
* **-T5 (Insane)**: Sehr schneller Scan, kann Netzwerke stark belasten und wird leicht entdeckt.

***

## Scan Status

<table data-full-width="false"><thead><tr><th width="284">Zustand</th><th>Beschreibung</th></tr></thead><tbody><tr><td><strong>open</strong></td><td>üü¢ Verbindung erfolgreich hergestellt (TCP, UDP oder SCTP).</td></tr><tr><td><strong>closed</strong></td><td>üî¥ Port ist geschlossen, TCP-Paket enth√§lt ein RST-Flag (zeigt aktive Systeme an).</td></tr><tr><td><strong>filtered</strong></td><td>‚ö™ Nmap kann nicht feststellen, ob der Port offen oder geschlossen ist, keine Antwort oder Fehlercode.</td></tr><tr><td><strong>unfiltered</strong></td><td>‚ö´ Port ist zug√§nglich (nur bei TCP-ACK-Scan), aber der Status (offen/geschlossen) ist unklar.</td></tr><tr><td><strong>open|filtered</strong></td><td>üü° Keine Antwort, m√∂glicherweise durch Firewall oder Paketfilter gesch√ºtzt.</td></tr><tr><td><strong>closed|filtered</strong></td><td>üîò Unklar, ob der Port geschlossen oder gefiltert ist (nur bei IP ID Idle Scans).</td></tr></tbody></table>
